#!/bin/bash

IFS=":" read -r ZONE MACHINE <<< "${1}"

# Source environment variables generated by firehpc for this zone
source /run/firehpc/${ZONE}.env

CMD="systemd-nspawn --quiet --keep-unit --boot --link-journal=try-guest --network-zone=${ZONE} --settings=override --machine=${MACHINE}.${ZONE} --bind=${ZONE_HOME}:/home"

exec $CMD
